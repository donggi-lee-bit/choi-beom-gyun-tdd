# 테스트 코드 작성 순서

2장에서 암호 강도 측정 기능을 TDD로 구현할 때 테스트 코드를 작성한 순서는 다음과 같은 규칙에 따라 나왔다.

- 쉬운 경우에서 어려운 경우로 진행
- 예외적인 경우에서 정상인 경우로 진행

반대로 어려운 경우를 먼저 시작하거나 정상 상황을 먼저 시작하면 구현 과정이 원활하게 진행되지 않기도 한다. 왜 그럴까

## 복잡한 테스트부터 시작하면 안 되는 이유

복잡한 상황을 테스트로 추가하면 해당 테스트를 통과시키기 위해 구현해야할 코드가 많아진다 <br>
암호 강도 측정 테스트를 예시로 들면
- 대문자 포함 규칙만 충족하는 경우
- 모든 규칙을 충족하는 경우
- 숫자를 포함하지 않고 나머지 규칙은 충족하는 경우

## 구현하기 쉬운 테스트부터 시작하기

구현하기 쉬운 경우부터 시작하면 빠르게 테스트를 통과시킬 수 있다. <br>
암호 강도 측정 예에서 가장 쉬워보이는 것은

- 모든 조건을 충족하는 경우
  - `STRONG` 리턴
- 모든 조건을 충족하지 않는 경우
  - `WEAK` 리턴

## 예외 상황을 먼저 테스트해야 하는 이유

예외 상황을 고려하지 않는 코드에 예외 상황을 반영하려면 코드 중간에 예외 상황을 처리하기 위해 조건문을 중복해서 추가해야한다. 이는 코드를 복잡하게 만들어 버그 발생 가능성을 높인다. <br>
<br>
초반에 예외 상황을 테스트하면 이런 가능성이 줄어든다. 예외 상황에 따른 if-else 구조가 미리 만들어지기 때문에 많은 코드를 완성한 뒤에 예외 상황을 반영할 때보다 코드 구조가 덜 바뀐다. <br>
<br>

## 완급 조절

처음 TDD로 구현할 때 어려운 것 중 하나는 한 번에 얼마만큼 코드를 작성해야하는 것인가.

1. 정해진 값을 리턴
2. 값 비교를 이용해서 정해진 값을 리턴
3. 다양한 테스트를 추가하면서 구현을 일반화

위 단계를 거쳐 연습하며 TDD를 익혀본다. <br>
단계적으로 나아가는 연습을 하지 않으면 한 번에 많은 코드를 구현하려고 시도하다 구현에 실패하게 된다. <br>

## 지속적인 리팩토링

테스트를 통과한 뒤에는 리팩토링을 진행한다. 매번 진행해야 하는 것은 아니지만 코드 중복과 같이 적당한 후보가 보이면 리팩토링을 진행한다.

### 테스트 대상 코드의 리팩토링 시점

상수를 변수로 바꾸거나 변수 이름을 변경하는 것과 같은 작은 리팩토링은 바로 실행 <br>
메서드 추출과 같이 메서드의 구조에 영향을 주는 리팩토링은 큰 틀에서 구현 흐름이 눈에 들어오기 시작한 뒤에 진행한다. <br>
<br>
구현 초기에는 전반적인 흐름을 모르기 때문에 메서드 추출과 같은 리팩토링을 진행하면 코드 구조를 잘못 잡을 가능성이 있다. 코드 구조가 잘못되면 코드가 복잡해지거나 구현을 진행하지 못하고 막힐 수 있다. <br>
코드의 의미나 구조가 더 명확해지면 그때 다시 리팩토링을 시도한다. <br>


